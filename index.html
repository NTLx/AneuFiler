<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>AneuFiler</title>
	<script src="node_modules/mdui/dist/js/mdui.min.js"></script>
	<link rel="stylesheet" href="node_modules/mdui/dist/css/mdui.min.css" />
</head>

<body class="mdui-theme-primary-indigo mdui-bottom-nav-fixed">
	<div class="mdui-tab mdui-tab-centered mdui-tab-full-width" mdui-tab>
		<a href="#tab1" class="mdui-ripple mdui-tab-active" onmousedown="mOver1(this)">
			<i id="tab1_icon" class="mdui-icon material-icons">&#xe24d;</i>
		</a>
		<a href="#tab4" class="mdui-ripple" onmousedown="mOver4(this)">
			<i id="tab4_icon" class="mdui-icon material-icons">&#xe865;</i>
		   </a>
		<a href="#tab2" class="mdui-ripple" onmousedown="mOver2(this)">
			<i id="tab2_icon" class="mdui-icon material-icons">&#xe8b8;</i>
		</a>
		<a href="#tab3" class="mdui-ripple" onmousedown="mOver3(this)">
			<i id="tab3_icon" class="mdui-icon material-icons">&#xe616;</i>
		</a>
	</div>
	<div id="tab1" class="mdui-p-a-1">
		<div id="holder"
			class="mdui-valign mdui-hoverable mdui-ripple mdui-shadow-1 mdui-m-a-2 mdui-color-theme mdui-img-rounded"
			style="height: 200px">
			<p class="mdui-center">
				<i class="mdui-icon material-icons">&#xe226;</i>文件处理区
			</p>
		</div>
		<div class="mdui-m-x-2 mdui-m-y-4">
			<button class="mdui-btn mdui-ripple mdui-color-orange mdui-btn-raised mdui-float-left"
				onclick="window.open('https://github.com/NTLx/AneuFiler')">
				<i class="mdui-icon material-icons">&#xe8fd;</i>帮助
			</button>
			<div class="mdui-valign mdui-float-left" style="height:15px;margin-left: 18px;">
				<p class="mdui-center">
					<br />注意：文件名当中不能含有空格、特殊符号、中文
				</p>
			</div>
			<button class="mdui-btn mdui-ripple mdui-color-teal mdui-btn-raised mdui-float-right" id="prompt"
				mdui-dialog="{target:'#closed'}">
				<i class="mdui-icon material-icons">&#xe879;</i>退出
			</button>

			<div class="mdui-dialog" id="closed">
				<div class="mdui-dialog-title">你确定要退出该窗口吗？</div>
				<div class="mdui-dialog-content"></div>
				<div class="mdui-dialog-actions">
					<button class="mdui-btn mdui-ripple" mdui-dialog-close>取消</button>
					<button class="mdui-btn mdui-ripple" mdui-dialog-confirm onclick="javascript:window.close()">
						确定
					</button>
				</div>
			</div>

		</div>
	</div>
	<div id="tab4" class="mdui-p-a-1">
		<div style="overflow-y: auto;height: 80vh;">
		  <button id="addUploadSample" class="mdui-btn mdui-ripple mdui-color-orange mdui-btn-raised">上传样本数据</button>
		  <p style="text-align: center;font-weight: bold;">样本信息数据</p>
		  <table border="1" id="tableContent" style="white-space: nowrap;text-align:center;">
			  <tr width="100%">
				<th>母亲样本编号</th>
				<th>胎儿样本编号</th>
				<th>母亲样本名</th>
				<th>胎儿样本名</th>
				<th>性别</th>
				<th>年龄</th>
				<th>与胎儿关系</th>
				<th>与母亲关系</th>
				<th>送检医师</th>
				<th>采样日期</th>
				<th>接收日期</th>
				<th>报告日期</th>
				<th>母亲样本类型</th>
				<th>胎儿样本类型</th>
				<th>母21</th>
				<th>母18</th>
				<th>母13</th>
				<th>母性染色体</th>
				<th>母备注</th>
				<th>胎儿21</th>
				<th>胎儿18</th>
				<th>胎儿13</th>
				<th>胎儿性染色体</th>
				<th>胎儿备注</th>
			  </tr>
		  </table>
		</div>
	</div>
	<div id="tab2" class="mdui-p-a-3">
		<div class="mdui-valign mdui-col-xs-4 mdui-center mdui-p-a-3">
			<label class="mdui-switch mdui-center">
				<input id="sample_out" type="checkbox" />
				<i class="mdui-switch-icon"></i>
				<span class="mdui-m-a-1">按样本输出</span>
			</label>
		</div>
		<div class="mdui-valign mdui-col-xs-4 mdui-center mdui-p-a-3">
			<label class="mdui-switch mdui-center">
				<input id="closebox" type="checkbox" />
				<i class="mdui-switch-icon"></i>
				<span class="mdui-m-a-1">关闭退出提示框</span>
			</label>
		</div>
		<div class="mdui-valign  mdui-col-xs-4 mdui-center mdui-p-a-3">
			<label class="mdui-switch mdui-center">
				<input id="report" type="checkbox" />
				<i class="mdui-switch-icon"></i>
				<span class="mdui-m-a-1">输出项目报告</span>
			</label>
		</div>
		<div class="mdui-valign mdui-center mdui-p-a-3">
			<label class="mdui-center">选择输出格式</label>
		</div>
		<div class="mdui-valign mdui-center" style="width: 140px; height: 40px">
			<form class="mdui-center mdui-p-a-1">
				<label class="mdui-radio mdui-center ">
					<input id="utf" type="radio" name="group1" />
					<i class="mdui-radio-icon"></i>UTF-8
				</label>
				<label class="mdui-radio mdui-center">
					<input id="gbk" type="radio" name="group1" checked />
					<i class="mdui-radio-icon"></i>GBK
				</label>
			</form>
		</div>
	</div>
	<div id="tab3" class="mdui-p-a-1">
		<div class="layout">
			<!-- <div class="mdui-col-xs-12  panel">日志信息</div> -->
			<!-- <div id="restore" class="mdui-col-xs-12 result2"></div> -->
			<button onclick="up()" class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple uptop">
				<i class="mdui-icon material-icons">&#xe5d8;</i>
			</button>
			<button onclick="down();" class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple ">
				<i class="mdui-icon material-icons">&#xe5db;</i>
			</button>
			<button onclick="download()" class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple download">
				<i class="mdui-icon material-icons">&#xe2c4;</i>
			</button>
			<!-- <i class="mdui-icon material-icons mdui-center">&#xe0d8;</i> -->
			<div id="test" style="overflow-y: auto;height: 85vh;">
			</div>
		</div>
	</div>
	<script>

		var $ = mdui.$;
		var switch_status = 0;
		var outputReportStatus = 0
		var out_status = function () {
			if ($("#sample_out").is(":checked")) {
				console.log("Sample split output is on");
				mdui.snackbar({ message: "输出将会按样本拆分" });
				switch_status = 1;
				
			} else {
				console.log("Sample split output is off");
				mdui.snackbar({ message: "每个输入文件将只输出一个结果文件" });
				switch_status = 0;
			}
		};
		var outputReport_status = function () {
			if ($("#report").is(":checked")) {
				console.log("打开输出项目报告");
				mdui.snackbar({ message: "打开输出项目报告" });
				outputReportStatus = 1;
				var tab4 = document.querySelector("#tab4_icon")
                tab4.click()
			} else {
				console.log("关闭输出项目报告");
				mdui.snackbar({ message: "关闭输出项目报告" });
				outputReportStatus = 0;
			}
		};
		var box_status = function () {
			if ($("#closebox").is(":checked")) {
				console.log("The exit prompt is closed");
				mdui.snackbar({ message: "关闭退出提示框" });
				closeBox();
			} else {
				console.log("The exit prompt is opend");
				mdui.snackbar({ message: "打开退出提示框" });
				openBox();
			}
		};
		$("#report").on("click", outputReport_status);
		$("#sample_out").on("click", out_status);
		$("#closebox").on("click", box_status);
		function closeBox() {
			const prompt = document.getElementById("prompt");
			prompt.removeAttribute("mdui-dialog");
			prompt.setAttribute("onclick", "javascript:window.close()");
		}
		function openBox() {
			const prompt = document.getElementById("prompt");
			prompt.removeAttribute("onclick");
			prompt.setAttribute("mdui-dialog", '{target:"#closed"}');
		}
		var Encoding = "GBK";
		var encod_status = function () {
			if ($("#utf").is(":checked")) {
				console.log("Output set UTF-8 Encode");
				mdui.snackbar({ message: "输出文件将以 UTF-8 格式编码" });
				Encoding = "UTF8";
			}
			if ($("#gbk").is(":checked")) {
				console.log("Output set GBK Encode");
				mdui.snackbar({ message: "输出文件将以 GBK 格式编码" });
				Encoding = "GBK";
			}
		};
		$("#utf").on("click", encod_status);
		$("#gbk").on("click", encod_status);

		function mOver1(obj) {
			mdui.snackbar({ message: "进入分析面板", timeout: 1000 });
		}
		function mOver2(obj) {
			mdui.snackbar({ message: "进入设置面板", timeout: 1000 });
		}
		function mOver3(obj) {
			mdui.snackbar({ message: "进入日志面板", timeout: 1000 })
		}
		function mOver4(obj) {
        	mdui.snackbar({ message:"进入出报告面板", timeout:1000 })
      	}
		// child_process.execFile method
		// var runningLogMessage = document.getElementById('restore').innerHTML
		// if (runningLogMessage === "") {
		// 	document.getElementById('restore').innerHTML += "<p style='text-align:center'>所有日志信息全部位于程序运行日志窗口中</p>"
		// }

		var path = require("path");
		var log = require('electron-log');
		const fs = require('fs')
		log.transports.console.level = 'silly';
		var nowdate = new Date();
		var { remote } = require('electron');
		var app = remote.app;
		// console.log(app.getPath('userData'));
		var filepath = path.join(app.getPath("temp"))
		console.log(filepath)
		var nowdate_str = nowdate.getFullYear() + "-" + (nowdate.getMonth() + 1) + "-" + nowdate.getDate()
		var filename = "AneuFiler.log"
		log.transports.file.resolvePath = () => path.join(filepath, filename)
		console.log(log.transports.file.resolvePath)
		// const content = fs.readFileSync(log.transports.file.resolvePath)
		// console.log(content)
		var exec = require("child_process").execFile;
	
		function start(file_path, Encoding, switch_status) {
				console.log("Request handler 'start' was called.");
				console.log(file_path)
			if (file_path.constructor === Array) {
				file_name = file_path[0].trim()
				fileName = file_name.substring(file_name.lastIndexOf('\\') + 1)
			} else {
				file_name = file_path.trim()
				fileName = file_name.substring(file_name.lastIndexOf('\\') + 1)
			}
			var exe_file;
			if (process.platform === "darwin") {
				exe_file = path.join(__dirname, "analysis.mac");
			}
			if (process.platform === "linux") {
				exe_file = path.join(__dirname,"analysis")
			}
			if (process.platform === "win32") {
				exe_file = path.join(__dirname, "analysis.exe");
			}
				exec(
				exe_file,
				["-i", file_path, "-e", Encoding, "-s", switch_status],
				function (error, stdout, stderr) {
					if (error || stderr) {
						var notice = "[WARNING] 输入文件 " + file_path + " 处理有误"
						mdui.snackbar({
							message: notice,
							position: "left-top",
							// onClick: function () {
							// 	ipc.send('tab3');
							// }
						})
						console.warn("stderr:\n" + stderr)
						log.warn("\n" + "当前处理文件名为：" + fileName + "\n报错提示：\n" + stderr)
						if (error !== null) {
							log.error("\n" + "当前处理文件名为：" + fileName + "\n错误提示：\n" + error)
						}
						// if (document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>') {
						// 	document.getElementById('restore').innerHTML = ""
						// }
						// document.getElementById('restore').innerHTML = '<br/>' + "<b style='color:#da242a'>当前处理文件名：</b>" + fileName + '<br/>'
					} else if (stdout) {
						setTimeout(function () {
							var notice = "输入文件 " + file_path + " 处理完成";
							mdui.snackbar({
								message: notice
							})
						}, 5000)
						// if (document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>') {
						// 	document.getElementById('restore').innerHTML = ""
						// }
						log.info("\n" + "当前处理文件名为：" + fileName + "\n处理文件耗时：\n" + stdout)

						// document.getElementById('restore').innerHTML ='<br/>' + "<b style='color:#67c23a'>当前处理文件名：</b>" + fileName + '<br/>' + "<b style='color:#67c23a'>处理文件耗时：</b>" + stdout + '<br/>'

					}
				}
			);
		}
		function sampleFileStart(file_path1){
			var path = require("path")
			var fs = require("fs")
        	var xlsx = require("node-xlsx")
			var sampleFileNamePath =file_path1[0].trim()
			console.log(sampleFileNamePath)
        	var sampleFileName = sampleFileNamePath.substring(sampleFileNamePath.lastIndexOf("\\")+1)
        	console.log("sampleFileName",sampleFileName)
        	var sampleFileNameCurrentPath = sampleFileNamePath.substring(0,sampleFileNamePath.lastIndexOf("\\")+1)
        	console.log("sampleFileNameCurrentPath",sampleFileNameCurrentPath)
        	log.info("\n"+"当前处理文件名："+sampleFileName+"\n"+"成功传入输入样本数据文件")
        	var sampleSheets = xlsx.parse(file_path1[0])
        	var sampleSheetsData = sampleSheets[0].data
        	var sampleLineData = []
        	var newSampleLineData = []
			var outFileName =[]
			var outFileNamePath=[]
			// var docx = []
			// var header1 =[]
			// var header2= []
			// var reportDateTime=[]
			// var footer2=[]
			for(var j=1;j<sampleSheetsData.length;j++){
          		sampleLineData.push(sampleSheetsData[j])
          		console.log("sampleLineData",sampleLineData)
        	}
			var displaySampleData = document.getElementById("tableContent")
        	displaySampleData.innerHTML=`<tr width="100%">
				<th>母亲样本编号</th>
				<th>胎儿样本编号</th>
				<th>母亲样本名</th>
				<th>胎儿样本名</th>
				<th>性别</th>
				<th>年龄</th>
				<th>与胎儿关系</th>
				<th>与母亲关系</th>
				<th>送检医师</th>
				<th>采样日期</th>
				<th>接收日期</th>
				<th>报告日期</th>
				<th>母亲样本类型</th>
				<th>胎儿样本类型</th>
				<th>母21</th>
				<th>母18</th>
				<th>母13</th>
				<th>母性染色体</th>
				<th>母备注</th>
				<th>胎儿21</th>
				<th>胎儿18</th>
				<th>胎儿13</th>
				<th>胎儿性染色体</th>
				<th>胎儿备注</th>
                </tr>`
				sampleLineData.forEach(function(item,index){
					var leftSlash ='/'
					if (sampleLineData[index][0] == ' ' || sampleLineData[index][0] == undefined) {
                  			sampleLineData[index][0] = leftSlash
              		}
					if (sampleLineData[index][1] == ' ' || sampleLineData[index][1] == undefined) {
                  			sampleLineData[index][1] = leftSlash
              		}
					if (sampleLineData[index][2] == ' ' || sampleLineData[index][2] == undefined) {
                  			sampleLineData[index][2] = leftSlash
              		}
              		if (sampleLineData[index][3] == ' ' || sampleLineData[index][3] == undefined) {
              		    sampleLineData[index][3] = leftSlash
              		}
              		if (sampleLineData[index][4] == ' ' || sampleLineData[index][4] == undefined) {
              		    sampleLineData[index][4] = leftSlash
              		}
					if (sampleLineData[index][5] == ' ' || sampleLineData[index][5] == undefined) {
              		    sampleLineData[index][5] = leftSlash
              		}
					if (sampleLineData[index][6] == ' ' || sampleLineData[index][6] == undefined) {
              		    sampleLineData[index][6] = leftSlash
              		}
              		if (sampleLineData[index][7] == ' ' || sampleLineData[index][7] == undefined) {
              		    sampleLineData[index][7] = leftSlash
              		}
              		if (sampleLineData[index][8] == ' ' || sampleLineData[index][8] == undefined) {
              		    sampleLineData[index][8] = ''
              		}
					if (sampleLineData[index][9] == ' ' || sampleLineData[index][9] == undefined) {
              		    sampleLineData[index][9] = ''
              		}
					if (sampleLineData[index][10] == ' ' || sampleLineData[index][10] == undefined) {
              		    sampleLineData[index][10] = ''
              		}
					  if (sampleLineData[index][11] == ' ' || sampleLineData[index][11] == undefined) {
              		    sampleLineData[index][11] = ''//报告日期
              		}
              		if (sampleLineData[index][12] == ' ' || sampleLineData[index][12] == undefined) {
              		    sampleLineData[index][12] = ''
              		}
					  if (sampleLineData[index][13] == ' ' || sampleLineData[index][13] == undefined) {
              		    sampleLineData[index][13] = ''//胎儿样本类型
              		}
              		if (sampleLineData[index][14] == ' ' || sampleLineData[index][14] == undefined) {
              		    sampleLineData[index][14] = leftSlash//母21
              		}
              		if (sampleLineData[index][15] == ' ' || sampleLineData[index][15] == undefined) {
              		    sampleLineData[index][15] = leftSlash//母18
              		}
					if (sampleLineData[index][16] == ' ' || sampleLineData[index][16] == undefined) {
              		    sampleLineData[index][16] = leftSlash//母13
              		}
					if (sampleLineData[index][17] == ' ' || sampleLineData[index][17] == undefined) {
              		    sampleLineData[index][17] = leftSlash//母性染色体
              		}
					if (sampleLineData[index][18] == ' ' || sampleLineData[index][18] == undefined) {
              		    sampleLineData[index][18] = ''//母备注
              		}
					if (sampleLineData[index][19] == ' ' || sampleLineData[index][19] == undefined) {
              		    sampleLineData[index][19] = leftSlash//胎儿21
              		}
					if (sampleLineData[index][20] == ' ' || sampleLineData[index][20] == undefined) {
              		    sampleLineData[index][20] = leftSlash//胎儿18
              		}
					if (sampleLineData[index][21] == ' ' || sampleLineData[index][21] == undefined) {
              		    sampleLineData[index][21] = leftSlash//胎儿13
              		}
					if (sampleLineData[index][22] == ' ' || sampleLineData[index][22] == undefined) {
              		    sampleLineData[index][22] = leftSlash//胎儿性染色体
              		}
					if (sampleLineData[index][23] == ' ' || sampleLineData[index][23] == undefined) {
              		    sampleLineData[index][23] = leftSlash//胎儿备注
              		}
					//   
					var Result ="本结果提示，胎儿样本未见母体DNA污染，"
					//判断规则1. 染色体都为2，性染色体全都对应XN 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+”-阴性“
					if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XN"){
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var sexChromosome = "未见异常"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosomeColor = "000000"
						var reportResult ="未见目标染色体数目异常"
						var reportResultColor ="000000"
						var reportOtherResult="，可排除18号、13号、21号三体型。"
						var simpleReport ="-阴性"
						
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="3"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XN"){
						//判断规则2. 胎儿21染色体为3，性染色体全都对应XN 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-T21”
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "提示三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="ff0000"
						var sexChromosome = "未见异常"
						var sexChromosomeColor = "000000"
						var reportResult ="提示21号染色体三体"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除18号、13号三体型。"
						var simpleReport ="-T21"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="3"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XN"){
						//判断规则3. 胎儿18染色体为3，性染色体全都对应XN 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-T18”
						var Trisomy13 = "未见三体"
						var Trisomy18 = "提示三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="ff0000"
						var Trisomy21Color="000000"
						var sexChromosome = "未见异常"
						var sexChromosomeColor = "000000"
						var reportResult ="提示18号染色体三体"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除21号、13号三体型。"
						var simpleReport ="-T18"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="3"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XN"){
						//判断规则4. 胎儿13染色体为3，性染色体全都对应XN 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-T13”
						var Trisomy13 = "提示三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="ff0000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosome = "未见异常"
						var sexChromosomeColor = "000000"
						var reportResult ="提示13号染色体三体"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除21号、18号三体型。"
						var simpleReport ="-T13"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="3"&&sampleLineData[index][20]=="3"&&sampleLineData[index][21]=="3"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XXX"){
						//判断规则5. 胎儿所有染色体为3，胎儿性染色体为XXX 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-三倍体”
						var Trisomy13 = "提示三体"
						var Trisomy18 = "提示三体"
						var Trisomy21 = "提示三体"
						var Trisomy13Color="ff0000"
						var Trisomy18Color="ff0000"
						var Trisomy21Color="ff0000"
						var sexChromosome = "提示XXX"
						var sexChromosomeColor = "ff0000"
						var reportResult ="提示三倍体XXX"
						var reportResultColor ="ff0000"
						var reportOtherResult="。"
						var simpleReport ="-三倍体"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="3"&&sampleLineData[index][20]=="3"&&sampleLineData[index][21]=="3"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="XXY"){
						//判断规则6. 胎儿所有染色体为3，胎儿性染色体为XXY 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-三倍体”
						var Trisomy13 = "提示三体"
						var Trisomy18 = "提示三体"
						var Trisomy21 = "提示三体"
						var Trisomy13Color="ff0000"
						var Trisomy18Color="ff0000"
						var Trisomy21Color="ff0000"
						var sexChromosome = "提示XXY"
						var sexChromosomeColor = "ff0000"
						var reportResult ="提示三倍体XXY"
						var reportResultColor ="ff0000"
						var reportOtherResult="。"
						var simpleReport ="-三倍体"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="性染色体数目异常"&&sampleLineData[index][23]=="未见明显MCC，提示X染色体单体，符合亲缘关系"){
						//判断规则7. 所有染色体为2，胎儿性染色体为性染色体数目异常 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-X单体”
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosome = "提示X染色体单体"
						var sexChromosomeColor = "ff0000"
						var reportResult ="性染色体数目提示X染色体单体"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除18号、13号、21号三体型。"
						var simpleReport ="-X单体"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="性染色体数目异常"&&sampleLineData[index][23]=="未见明显MCC，提示XXY，符合亲缘关系"){
						//判断规则8. 所有染色体为2，胎儿性染色体为性染色体数目异常 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+”-XXY“
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosome = "提示XXY"
						var sexChromosomeColor = "ff0000"
						var reportResult ="性染色体数目提示XXY"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除18号、13号、21号三体型。"
						var simpleReport ="-XXY"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="性染色体数目异常"&&sampleLineData[index][23]=="未见明显MCC，提示XXX，符合亲缘关系"){
						//判断规则9. 所有染色体为2，胎儿性染色体为性染色体数目异常 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+“-XXX”
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosome = "提示XXX"
						var sexChromosomeColor = "ff0000"
						var reportResult ="性染色体数目提示XXX"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除18号、13号、21号三体型。"
						var simpleReport ="-XXX"
					}else if(sampleLineData[index][14]=="2"&&sampleLineData[index][15]=="2"&&sampleLineData[index][16]=="2"&&sampleLineData[index][19]=="2"&&sampleLineData[index][20]=="2"&&sampleLineData[index][21]=="2"&&sampleLineData[index][17]=="XN"&&sampleLineData[index][22]=="性染色体数目异常"&&sampleLineData[index][23]=="未见明显MCC，提示XYY，符合亲缘关系"){
						//判断规则10. 所有染色体为2，胎儿性染色体为性染色体数目异常 报告名：“胎儿样本编号”+“胎儿样本名”+“Qpcr快检”+”-XYY“
						var Trisomy13 = "未见三体"
						var Trisomy18 = "未见三体"
						var Trisomy21 = "未见三体"
						var Trisomy13Color="000000"
						var Trisomy18Color="000000"
						var Trisomy21Color="000000"
						var sexChromosome = "提示XYY"
						var sexChromosomeColor = "ff0000"
						var reportResult ="性染色体数目提示XYY"
						var reportResultColor ="ff0000"
						var reportOtherResult="，可排除18号、13号、21号三体型。"
						var simpleReport ="-XYY"
					}
					// 报告日期
					var reportDateTime = sampleLineData[index][11]
					//日期格式转换
					function formatDate1(numb, format="年",format1="月",format2="日") {
						let time = new Date((numb - 1) * 24 * 3600000 + 1)
						time.setYear(time.getFullYear() - 70)
						let year = time.getFullYear() + ''
						let month = time.getMonth() + 1 + ''
						let date = time.getDate() + ''
						if(format && format.length === 1) {
						    return year + format + (month < 10 ? '0' + month : month) + format1 + (date < 10 ? '0' + date : date)+format2
						}
						return year+(month < 10 ? '0' + month : month)+(date < 10 ? '0' + date : date)
					}
					//采样日期
					var samplingDate = sampleLineData[index][9]
					function formatDate2(numb, format="-") {
						let time = new Date((numb - 1) * 24 * 3600000 + 1)
						time.setYear(time.getFullYear() - 70)
						let year = time.getFullYear() + ''
						let month = time.getMonth() + 1 + ''
						let date = time.getDate() + ''
						if(format && format.length === 1) {
						    return year + format + (month < 10 ? '0' + month : month) + format +(date < 10 ? '0' + date : date)
						}
						return year+(month < 10 ? '0' + month : month)+(date < 10 ? '0' + date : date)
					}
					//接收日期
					var ReceiveDate = sampleLineData[index][10]
					//调用日期格式转换方法
					var newReportDate=formatDate1(reportDateTime)
					var newSamplingDate = formatDate2(samplingDate)
					var newReceiveDate = formatDate2(ReceiveDate)
					displaySampleData.innerHTML += "<tr><td>" + sampleLineData[index][0] + "</td><td>" + sampleLineData[index][1] + "</td><td>" + sampleLineData[index][2] + "</td><td>" + sampleLineData[index][3] + "</td><td>" + sampleLineData[index][4] + "</td><td>" + sampleLineData[index][5] + "</td><td>" + sampleLineData[index][6] + "</td><td>" + sampleLineData[index][7] + "</td><td>" + sampleLineData[index][8] + "</td><td>" + newSamplingDate +"</td><td>" + newReceiveDate +"</td><td>" + newReportDate + "</td><td>" + sampleLineData[index][12] + "</td><td>" + sampleLineData[index][13] + "</td><td>" + sampleLineData[index][14] +"</td><td>" + sampleLineData[index][15] +"</td><td>" + sampleLineData[index][16]+"</td><td>" + sampleLineData[index][17]+"</td><td>" + sampleLineData[index][18]+"</td><td>" + sampleLineData[index][19]+"</td><td>" + sampleLineData[index][20]+"</td><td>" + sampleLineData[index][21]+"</td><td>" + sampleLineData[index][22]+"</td><td>" + sampleLineData[index][23]+"</td></tr>"
					var officegen = require("officegen");
					var fs = require("fs");
					
					docx = officegen({
					  type: "docx",
					  pageMargins: {
					    top: 141,
					    bottom: 850,
					    left: 908,
					    right: 908,
					  },
					  columns:"1"
					}); //word

					docx.on("finalize", function (written) {
					  console.log(
					    "Finish to create Word file.\nTotal bytes created: " + written + "\n"
					  );
					});

					docx.on("error", function (err) {
					  console.log(err);
					});
					var header1 = docx.getHeader().createP();
					var header2 = docx.getHeader().createP({ align: "right", superscript: true, subscript: true });
					// var pObj = docx.createP()
					var pic = path.join(__dirname,"./hunanjiahui.png")
					console.log("pic",pic)
					header1.addImage(path.join(__dirname,"./hunanjiahui.png"), {
					  cx: 685,
					  cy: 75,
					  underline:true,
					  color:"ff0000"
					});
					header2.addText("家系编号:", { font_size: 10.5,line_height:200});
					var footer = docx.getFooter().createP();
					var footer1 = docx.getFooter().createP();
					var InspectorName = "刘鑫林";
					var ReviewerName = "曾桥";
					var chiefPhysicianName = "邬玲仟";
					var telephone = "0731-84805365";
					var addressName = "湖南省长沙市开福区湘雅路74号";

					console.log("reportDateTime",reportDateTime)
					footer.addHorizontalLine()
					footer1.addText("检测人：",{font_size:9,bold:true})
					footer1.addText(InspectorName,{font_size:9})
					footer1.addText("                                            审核人：",{font_size:9,bold:true})
					footer1.addText(ReviewerName,{font_size:9})
					footer1.addText("                                                                                      主任医师：",{font_size:9,bold:true})
					footer1.addText(chiefPhysicianName,{font_size:9})
					var footer2 = docx.getFooter().createP();
					// console.log("footer2[index]",footer2[index])
					footer2.addText("咨询热线：",{font_size:9,bold:true})
					footer2.addText(telephone,{font_size:9,font_face:"Times New Roman"})
					footer2.addText("                         地址：",{font_size:9,bold:true})
					footer2.addText(addressName,{font_size:9,font_face:"Times New Roman",font_face_east:"SimSun"})
					footer2.addText("                                   报告日期：",{font_size:9,bold:true})
					footer2.addText(newReportDate,{font_size:9,font_face:"Times New Roman",font_face_east:"SimSun"})
					//var tows = ['id', 'provinceZh', 'leaderZh', 'cityZh', 'cityEn'];//创建一个和表头对应且名称与数据库字段对应数据，便于循环取出数据
					var pObj = docx.createP({ align: "center" }); // 创建行 设置居中 大标题
					pObj.addText("QF-PCR母血污染鉴定及快速筛查检测报告", {
					  bold: true,
					  font_size: 18,
					  font_face:"Times New Roman",
					  font_face_east:"SimSun"
					}); // 添加文字 设置字体样式 加粗 大小
					var pObj1 = docx.createP({ align: "left" });
					pObj1.addText("样本信息", { bold: true, font_size: 12 });
					var data1 = [
					  [
					    {
					      type: "text",
					      val: "家系编号： ",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: "",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: "                                                                                                      送检机构：",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: "三亚市妇幼保健院",
					      opt: { font_size: 10.5 },
					    },
					  ],
					  [
					    {
					      type: "text",
					      val: "检测类型：",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: "QF-PCR母血污染鉴定及快速筛查检测",
					      opt: { font_size: 10.5,font_face:"Times New Roman",font_face_east:"SimSun"},
					    },
					    {
					      type: "text",
					      val: "                             送检医师：",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: sampleLineData[index][8],
					      opt: { font_size: 10.5 },
					    },
					  ],
					  [
					    {
					      type: "text",
					      val: "采样日期：",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: newSamplingDate,
					      opt: { font_size: 10.5,font_face:"Times New Roman"},
					    },
					    {
					      type: "text",
					      val: "                                                                                  接收日期：",
					      opt: { font_size: 10.5 },
					    },
					    {
					      type: "text",
					      val: newReceiveDate,
					      opt: { font_size: 10.5,font_face:"Times New Roman"},
					    },
					  ],
					];
					docx.createByJson(data1);
					var style = {
					  "@w:val": "single",
					  "@w:sz": "4",
					  "@w:space": "0",
					  "@w:color": "000000", //黑色
					};
					var borderStyle = {
					  "w:top": style,
					  "w:bottom": style,
					  // 'w:left': style2,
					  // 'w:right': style2,
					  "w:insideH": style,
					  // 'w:insideV': style,
					};
					var table1 = [
					  [
					    {
					      val: "样本编号",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        // cellColWidth: 42,
					        cellColWidth: 1200,
					        b: true,
					        // sz: '48',
					        shd: {
					          fill: "71c3fb",
					        },
					        // fontFamily: "Avenir Book"
					      },
					    },
					    {
					      val: "姓名",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        // cellColWidth: 1500,
					        // b:true,
					        // color: "A00000",
					        // align: "right",
					        shd: {
					          fill: "71c3fb",
					        },
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "性别",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "年龄",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "关系",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "样本类型",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        cellColWidth: 2000,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "备注",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    {
					      val: sampleLineData[index][0],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					        fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: sampleLineData[index][2],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 1500,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sampleLineData[index][4],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sampleLineData[index][5],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					        fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: sampleLineData[index][6],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sampleLineData[index][12],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 1600,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: '',
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    {
					      val: sampleLineData[index][1],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					        fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: sampleLineData[index][3],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 1600,
					        fixedLayout: true,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sampleLineData[index][7],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sampleLineData[index][13],
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: '',
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        // cellColWidth: 42,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					];
					var tableStyle1 = {
					  tableColWidth: 1400,
					  tableSize: 18,
					  tableColor: "ada",
					  tableAlign: "left",
					  tableVAlign: "center",
					  //   borders: true,
					  borderStyle: borderStyle,
					  //   columns:[{width:1200},{width:1600},{width:100},{width:100},{width:100},{width:1500},{width:100}]
					};
					docx.createTable(table1, tableStyle1);
					var pObj4 = docx.createP();
					pObj4.addText("");
					var pObj2 = docx.createP({ align: "left" });
					pObj2.addText("检测项目", { bold: true, font_size: 12 });
					var table2 = [
					  [
					    {
					      val: "项目类型",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        // cellColWidth: 42,
					        cellColWidth: 2500,
					        b: true,
					        // sz: '48',
					        shd: {
					          fill: "71c3fb",
					        },
					        // fontFamily: "Avenir Book"
					      },
					    },
					    {
					      val: "检测范围",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        cellColWidth: 4000,
					        // b:true,
					        // color: "A00000",
					        // align: "right",
					        shd: {
					          fill: "71c3fb",
					        },
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: "检测方法",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        shd: {
					          fill: "71c3fb",
					        },
					        cellColWidth: 4000,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    {
					      val: "QF-PCR母血污染鉴定",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 2200,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily:"Times New Roman"
					      },
					    },
					    {
					      val: "13, 18, 21, X, Y染色体",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 3500,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily:"Times New Roman"
					      },
					    },
					    {
					      val: "QF-PCR + 毛细管电泳扫描",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 3000,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily:"Times New Roman"
					      },
					    },
					  ],
					];
					// var style2 = {
					//     '@w:val': 'single',
					//     '@w:sz': '4',
					//     '@w:space': '0',
					//     '@w:color': '000000'//黑色
					//   }
					// // var style2 ={
					// //     '@w:val': 'single',
					// //     '@w:sz': '4',
					// //     '@w:space': '1',
					// //     '@w:color': 'FFFFFF'//白色
					// // }
					// var borderStyle = {
					//     'w:top': style2,
					//     'w:bottom': style2,
					//     // 'w:left': style2,
					//     // 'w:right': style2,
					//     'w:insideH': style2,
					//     // 'w:insideV': style,
					//   }
					var tableStyle2 = {
					  tableColWidth: 8600,
					  tableSize: 18,
					  tableColor: "ada",
					  tableAlign: "left",
					  tableVAlign: "center",
					  //   borders: true,
					  borderStyle: borderStyle,
					  //   columns:[{width:1200},{width:1600},{width:100},{width:100},{width:100},{width:1500},{width:100}]
					};
					docx.createTable(table2, tableStyle2);
					var pObj5 = docx.createP();
					pObj5.addText("");
					var pObj3 = docx.createP({ align: "left" });
					pObj3.addText("筛查检测结果", { bold: true, font_size: 12 });

					var table3 = [
					  [
					    {
					      val: "母血污染分析结果",
					      opts: {
					        align: "center",
					        vAlign: "center",
					        sz: "21",
					        // cellColWidth: 42,
					        cellColWidth: 3500,
					        b: true,
					        // sz: '48',
					        // shd: {
					        //   fill: "71c3fb",
					        // },
					        // fontFamily: "Avenir Book"
					      },
					    },
					    {
					      val: "胎儿样本未见母体DNA污染",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        gridSpan: 2,
					        cellColWidth: 7000,
					        // b:true,
					        // color: "A00000",
					        // align: "right",
					        // shd: {
					        //   fill: "71c3fb",
					        // },
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					  ],
					  [
					    {
					      val: "QF-PCR分析结果",
					      opts: {
					        align: "center",
					        vAlign: "center",
					        sz: "21",
					        b: true,
					        cellColWidth: 2200,
					        vMerge: "restart",
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: "13三体",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 2600,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: Trisomy13,
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
							color:Trisomy13Color,
					        cellColWidth: 3200,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    { opts: { vMerge: "continue" } },
					    {
					      val: "18三体",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 2600,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: Trisomy18,
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 3000,
							color:Trisomy18Color,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    { opts: { vMerge: "continue" } },
					    {
					      val: "21三体",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 2600,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
							fontFamily: "Times New Roman"
					      },
					    },
					    {
					      val: Trisomy21,
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 3000,
							color:Trisomy21Color,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					  ],
					  [
					    { opts: { vMerge: "continue" } },
					    {
					      val: "性染色体",
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        //   b:true,
					        cellColWidth: 2600,
					        // b:true,
					        // sz: '48',
					        // shd: {
					        //   fill: "92CDDC",
					        //   themeFill: "text1",
					        //   "themeFillTint": "80"
					        // }
					      },
					    },
					    {
					      val: sexChromosome,
					      opts: {
					        align: "left",
					        vAlign: "center",
					        sz: "21",
					        b:true,
					        cellColWidth: 3000,
							color:sexChromosomeColor,
							fontFamily: "Times New Roman"
					      },
					    },
					  ],
					];
					var tableStyle3 = {
					  tableColWidth: 8500,
					  tableSize: 18,
					  tableColor: "ada",
					  tableAlign: "left",
					  tableVAlign: "center",
					  //   borders: true,
					  borderStyle: borderStyle,
					  //   columns:[{width:1200},{width:1600},{width:100},{width:100},{width:100},{width:1500},{width:100}]
					};
					docx.createTable(table3, tableStyle3);
					var pObj6 = docx.createP({ align: "left" });
					pObj6.addText("结果描述：", { bold: true, font_size: 10.5 });
					var pObj7 = docx.createP({indentFirstLine:"440"});
					pObj7.addText(Result,{font_size: 10.5,font_face:"Times New Roman",font_face_east:"SimSun"});
					console.log("Result",Result)
					console.log("reportResult",reportResult)
					console.log("sexChromosome",sexChromosome)
					console.log("reportOtherResult",reportOtherResult)
					pObj7.addText(reportResult,{font_size: 10.5,color:reportResultColor,bold: true,font_face:"Times New Roman",font_face_east:"SimSun"});
					pObj7.addText(reportOtherResult,{font_size: 10.5,font_face:"Times New Roman",font_face_east:"SimSun"});
					var pObj8 = docx.createP();
					pObj8.addText("");
					var pObj16 = docx.createP()
					pObj16.addText("检测方法：",{bold:true,font_size: 10.5})
					pObj16.addText("DNA从样本中抽提并纯化后，采用多重荧光DNA模板进行扩增，扩增产物在遗传分析仪上进行电泳分析。",{font_size: 10.5,font_face:'Times New Roman',font_face_east:'SimSun'})
					// var data2 = [
					//   [
					//     {
					//       type: "text",
					//       val: "检测方法：",
					//       opt: { bold: true, font_size: 10.5 },
					//     },
					//     {
					//       type: "text",
					//       val: "DNA从样本中抽提并纯化后，采用多重荧光PCR对DNA模板进行扩增，扩增产物在遗传分析仪上进行电泳分析。",
					//       opt: { font_size: 10.5 },
					//     },
					//   ],
					// ];
					// docx.createByJson(data2);
					var pObj9 = docx.createP({ align: "left" });
					pObj9.addText("局限性声明：", { bold: true, font_size: 10.5 });
					// var pObj10 = docx.createListOfNumbers ();
					var pObj10 = docx.createP();
					pObj10.addText("1.本检测结果仅为筛查结果，不作为产前诊断结果，不单独作为确诊或排除病例的依据，最终结果需要核型分析方法进行确诊。阴性结果不能排除其他染色体三体，其结果的确认应结合临床进行综合判断；",{font_size: 10.5,font_face:'Times New Roman',font_face_east:'SimSun'});
					var pObj11 = docx.createP();
					pObj11.addText("2.本检测仅对21号，18号，13号及性染色体进行筛查检测，不能排除其他染色体异常。且只能排除染色体数目异常，不能排除染色体结构异常，亦不能排除微小染色体异常或某些基因突变；",{font_size: 10.5,font_face:'Times New Roman',font_face_east:'SimSun'});
					var pObj12 = docx.createP();
					pObj12.addText("3.本检测不能检测21号、18号、13号及性染色体低比例嵌合体现象。",{font_size: 10.5,font_face:"Times New Roman",font_face_east:'SimSun'});
					// 本检测不能检测21号、18号、13号及性染色体低比例嵌合体现象。
					// word分页
					docx.putPageBreak();
					var pObj13 = docx.createP({ align: "left" });
					pObj13.addText("QF-PCR毛细管电泳扫描结果：", { bold: true, font_size: 10.5,font_face:"Times New Roman",font_face_east:'SimSun'});
					outFileName[index] =sampleLineData[index][1]+sampleLineData[index][3]+"Qpcr快检"+simpleReport+".docx"
					console.log("outFileName[index]",outFileName[index])
					outFileNamePath[index] = path.join(sampleFileNameCurrentPath,outFileName[index])
					console.log("outFileNamePath[index]",outFileNamePath[index])
					var out = fs.createWriteStream(outFileNamePath[index]); // 文件写入
					out.on("error", function (err) {
					  console.log(err);
					});
					var result1 = docx.generate(out); // 当前目录生成word
					console.log("result1", result1);

				})	
		}
		// event: drag file(s) to window
		const holder = document.getElementById("holder");
		holder.ondragover = () => {
			return false;
		};
		holder.ondragleave = holder.ondragend = () => {
			return false;
		};
		holder.ondrop = (e) => {
			e.preventDefault();
			for (let f of e.dataTransfer.files) {
				console.log("File(s) you dragged here: ", f.path);
				start(f.path, Encoding, switch_status);
			}
			return false;
		};
		// event: click to open file manager
		const os = require("os");
		let default_path = os.homedir();
		const { dialog } = require("electron").remote;
		const fileManagerBtn = document.getElementById("holder");
		fileManagerBtn.addEventListener("click", showOpenDialogHandler);
		function showOpenDialogHandler() {
			var options = {
				defaultPath: default_path,
				filters: [{ name: "RawData", extensions: ["txt", "csv"] }],
				properties: ["openFile"],
			};
			dialog
				.showOpenDialog(options)
				.then((result) => {
					console.log("Select file" + result.filePaths);
					console.log(result.filePaths);
					if (!result.filePaths[0]) {
						console.log("No file selected");
						mdui.snackbar({ message: "未选择任何文件" });
						return;
					} else {
						start(result.filePaths, Encoding, switch_status);
					}
				})
				.catch((err) => {
					// console.log(err);
					console.log("No file selected");
				});
		}
		var uploadSample = document.getElementById("addUploadSample")
      	uploadSample.addEventListener("click",showUploadSampleDialog);
      	function showUploadSampleDialog(){
      	  var options= {
      	    defaultPath:default_path,
      	    filters:[{name:"RawData",extensions:["xlsx","xls"]}],
      	    properties:["openFile"]
      	  }
      	  dialog.showOpenDialog(options).then((result)=>{
      	    console.log("Now Select sample file"+result.filePaths)
      	    if(!result.filePaths[0]){
      	      console.log("No sample file selected")
      	      mdui.snackbar({message:"未选择样本文件"})
      	      return
      	    }else{
      	      sampleFileStart(result.filePaths)
      	    }
      	  }).catch((err)=>{
      	    console.log("err",err)
      	  })
      	}
		const tab3 = document.querySelector("#tab3_icon")
		const ipc = require('electron').ipcRenderer
		tab3.onclick = () => {
			var content = fs.readFileSync(path.join(filepath, filename))
			var array = content.toString().split("\n")
			// console.log(array)
			var reg1 = RegExp(/warn/)
			var reg2 = RegExp(/info/)
			var message = document.getElementById('test')
			message.innerHTML = ""
			for (var i = 0; i < array.length; i++) {
				if (array[i].match(reg1)) {
					array[i] = "<p style='color:#FF5722;text-align:center'>" + array[i] + "</p>"
					// console.log(array[1])
				} else if (array[i].match(reg2)) {
					array[i] = "<p style='color:#4CAF50;text-align:center'>" + array[i] + "</p>"
				} else {
					array[i] = "<p style='margin:10px'>" + array[i] + "</p>"
				}
				// console.log(message.innerHTML)
				message.innerHTML += array[i].toString()
			}
			const ipc = require('electron').ipcRenderer
			// const remote1 = require('electron').remote;
			const FindInPage = require('electron-find').FindInPage;
			let findInPage = new FindInPage(remote.getCurrentWebContents());
			ipc.on('on-find', (e, args) => {
				findInPage.openFindWindow()
			})
		}

	</script>
	<script type="text/javascript">
		function download() {
			var filePath = path.join(filepath, filename);//需要下载文件的路径
			var win = remote.getCurrentWindow();
			win.webContents.downloadURL(filePath);
			// mac 版本
			// win.webContents.downloadURL("file:///"+filePath)
			console.log(filePath)
			// console.log(win.webContents.downloadURL(filePath))
		}
		function down() {
			const div = document.getElementById('test')
			console.log(div.scrollHeight)
			div.scrollTop = div.scrollHeight
			console.log(div.scrollTop)
		}
		function up() {
			const div1 = document.getElementById('test')
			div1.scrollTop = 0
		}

	</script>

	<style>
		body {
			overflow: hidden;
		}

		.uptop {
			margin-bottom: 50px;
		}

		.download {
			margin-bottom: 160px;
		}
	</style>
	<style>
		.body {
			overflow-x: hidden;
		}

		.panel {
			text-align: center;
			font-size: 16px;
			margin-top: 16px;
		}

		.result1 {
			margin-top: 16px;
			height: 200px;
			overflow-y: auto;
			overflow-x: hidden;
			padding-left: 36px;
			padding-right: 36px;
			transition: all .5s;
		}

		.result2 {
			margin-top: 16px;
			height: 200px;
			overflow-y: auto;
			padding-left: 36px;
			padding-right: 36px;
		}

		@media (min-height: 410px) {
			.result2 {
				height: 200px;
			}
		}

		@media (min-height: 460px) {
			.result2 {
				height: 320px;
			}
		}

		@media (min-height: 500px) {
			.result2 {
				height: 360px;
			}
		}

		@media (min-height:600px) {
			.result2 {
				height: 460px;
			}

		}

		@media (min-height: 700px) {

			.result2 {
				height: 560px;
			}
		}

		@media (min-height:850px) {

			.result2 {
				height: 710px;
			}
		}

		@media (min-height: 1000px) {
			.result2 {
				height: 860px;
			}
		}
	</style>
</body>

</html>